[tox]
# These should match the travis env list
envlist = py26 py27 py34 py35 pypy pypy3 lint

[testenv]
install_command = pip install --download-cache=~/.pip/cache {opts} {packages}
deps =
    -rrequirements.d/test.txt
# `changedir` ensures we run against the installed, rather than the working directory:
passenv =
    TRAVIS_PYTHON_VERSION
changedir = 
    {envtmpdir}
setenv = 
    TOP={toxinidir}
    SITEPACKAGES={envsitepackagesdir}
commands =
    pip freeze
    pip --version
    {toxinidir}/test {posargs}

[testenv:lint]
deps =
    -rrequirements.d/lint.txt
commands =
    sh -c 'make -C $TOP lint'
whitelist_externals =
    sh

[testenv:docs]
deps = -rrequirements.d/docs.txt
changedir = docs
commands = sphinx-build -b html -d build/doctrees source build/html
